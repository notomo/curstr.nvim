set encoding=utf-8

call themis#option('recursive', 1)

if exists('$CURSTR_ENV')
    let g:python3_host_prog = expand('<sfile>:h:h') . '/curstr_env/bin/python3'
endif
runtime! plugin/rplugin.vim

let s:packpath = &packpath

call curstr#test#start_testing()

function! CurstrTestBefore() abort
    let s:root = getcwd()
    return s:root
endfunction

function! CurstrTestBeforeEach() abort
    let &packpath = s:packpath
endfunction

function! CurstrTestAfterEach() abort
    %bwipeout!
    call curstr#custom#clean()
    execute 'cd ' . s:root
endfunction

execute 'profile' 'start' $THEMIS_PROFILE_LOG
profile! file ./autoload/*
